#! /usr/bin/python

import numpy as np
import matplotlib.pyplot as plt

#data = np.loadtxt('./burst_len_youtube.txt')

ax = plt.subplot(111)
burst_len = ( 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 127, 128, 129, 133, 224, 225, 226, 228, 231, 232, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 344, 346, 353, 354, 789, 802, 803, 818, 822, 825, 826, 827, 828, 829, 830, 831, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 991, 992, 993, 994, 995, 997, 999, 1004, 1018, 1019, 2677, 2706, 2721, 2726, 2730, 2733, 2736, 2738, 2740, 2743, 2745, 2754, 2755, 2756, 2758, 2759, 2760, 2761, 2762, 2764, 2765, 2768, 2769, 2770, 2772, 2773, 2774, 2775, 2776, 2777, 2779, 2781, 2782, 2783, 2784, 2785, 2787, 2788, 2790, 2791, 2792, 2793, 2794, 2795, 2796, 2797, 2798, 2799, 2800, 2801, 2802, 2803, 2804, 2805, 2806, 2807, 2809, 2810, 2811, 2812, 2813, 2814, 2815, 2816, 2817, 2818, 2819, 2820, 2821, 2822, 2823, 2824, 2825, 2826, 2827, 2828, 2829, 2830, 2831, 2832, 2833, 2834, 2835, 2836, 2837, 2838, 2839, 2840, 2841, 2842, 2843, 2844, 2845, 2846, 2847, 2848, 2849, 2850, 2851, 2852, 2853, 2854, 2855, 2856, 2857, 2858, 2859, 2860, 2861, 2862, 2863, 2864, 2865, 2866, 2867, 2868, 2869, 2870, 2871, 2872, 2873, 2874, 2875, 2876, 2877, 2878, 2879, 2880, 2881, 2882, 2883, 2884, 2885, 2886, 2887, 2888, 2889, 2890, 2891, 2892, 2893, 2894, 2895, 2896, 2897, 2898, 2899, 2900, 2901, 2902, 2903, 2904, 2905, 2906, 2907, 2908, 2909, 2910, 2911, 2912, 2913, 2914, 2915, 2916, 2917, 2918, 2919, 2920, 2921, 2922, 2923, 2924, 2925, 2926, 2927, 2928, 2929, 2930, 2931, 2932, 2933, 2934, 2935, 2936, 2937, 2938, 2939, 2940, 2941, 2942, 2943, 2944, 2945, 2946, 2947, 2949, 2950, 2951, 2952, 2953, 2954, 2955, 2956, 2958, 2959, 2960, 2961, 2963, 2964, 2965, 2967, 2968, 2969, 2970, 2971, 2972, 2973, 2974, 2975, 2977, 2978, 2980, 2981, 2984, 2986, 2988, 2990, 2992, 2994, 2997, 3000, 3003, 3006, 3009, 3010, 3013, 3015, 3018, 3019, 8844, 8878, 8892, 8894, 8906, 8911, 8916, 8920, 8927, 8934, 8937, 8950, 8957, 8964, 8968, 8978, 8982, 8983, 8986, 8989, 8994, 8999, 9005, 9006, 9009, 9011, 9012, 9013, 9014, 9015, 9019, 9022, 9024, 9028, 9032, 9034, 9037, 9039, 9040, 9045, 9046, 9049, 9051, 9052, 9054, 9055, 9057, 9059, 9060, 9062, 9063, 9064, 9070, 9071, 9072, 9073, 9075, 9076, 9078, 9079, 9086, 9087, 9089, 9091, 9092, 9093, 9097, 9099, 9100, 9101, 9108, 9114, 9115, 9116, 9117, 9118, 9119, 9121, 9123, 9124, 9125, 9128, 9129, 9133, 9135, 9137, 9140, 9144, 9146, 9148, 9150, 9152, 9157, 9158, 9160, 9161, 9163, 9166, 9171, 9173, 9177, 9178, 9183, 9188, 9191, 9193, 9194, 9198, 9199, 9201, 9202, 9203, 9205, 9206, 9207, 9209, 9210, 9211, 9213, 9224, 9226, 9229, 9233, 9234, 9239, 9244, 9248, 9253, 9255, 9257, 9261, 9263, 9288, 9299, 9305, 9318, 9326, 9361, 28564, 28621, 28638, 28644, 28666, 28673, 28683, 28707, 28736, 28764, 28790, 28794, 28869, 28895, 28909, 28914, 29145, 29180, 90873)
burst_freq = ( 17080644, 30349, 23277, 16859, 12530, 10636, 10211, 10554, 10106, 8999, 7444, 5515, 3914, 2624, 1548, 990, 762, 697, 852, 1053, 1467, 1791, 2386, 2815, 3176, 3518, 3616, 3801, 3653, 3492, 3314, 2970, 2514, 2113, 1718, 1374, 1054, 857, 575, 421, 289, 201, 148, 92, 58, 40, 22, 7, 5, 3, 5, 1, 1, 1, 1, 2, 3, 1, 8, 9, 15, 25, 34, 44, 46, 65, 67, 113, 113, 152, 208, 253, 303, 389, 421, 471, 548, 656, 723, 827, 897, 943, 958, 1043, 1063, 1107, 1160, 1116, 1138, 1063, 1102, 1021, 1044, 878, 841, 824, 744, 666, 570, 544, 523, 452, 352, 293, 235, 188, 173, 160, 94, 105, 73, 66, 42, 37, 25, 25, 22, 10, 5, 7, 8, 3, 2, 1, 4, 5, 1, 1, 1, 1, 1, 1, 2, 2, 3, 2, 2, 5, 5, 5, 5, 11, 11, 10, 10, 17, 8, 27, 29, 29, 33, 38, 38, 42, 57, 57, 58, 78, 82, 93, 83, 105, 145, 104, 141, 117, 156, 161, 163, 175, 176, 168, 192, 188, 207, 210, 259, 244, 236, 231, 260, 283, 272, 284, 279, 262, 258, 262, 276, 281, 273, 280, 233, 231, 254, 229, 215, 216, 210, 188, 178, 181, 184, 145, 145, 134, 133, 116, 112, 91, 104, 89, 77, 67, 67, 69, 59, 54, 52, 32, 34, 36, 29, 20, 19, 15, 17, 19, 9, 10, 9, 10, 11, 5, 4, 3, 2, 4, 3, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 4, 1, 1, 1, 1, 2, 2, 3, 3, 3, 5, 3, 4, 8, 7, 7, 6, 4, 3, 5, 7, 7, 8, 8, 9, 5, 9, 10, 13, 10, 12, 10, 12, 10, 17, 11, 17, 19, 14, 18, 25, 19, 16, 21, 32, 28, 25, 24, 22, 25, 31, 33, 30, 30, 36, 26, 28, 36, 45, 35, 46, 39, 40, 38, 46, 47, 43, 29, 53, 51, 32, 48, 63, 48, 55, 59, 45, 57, 50, 54, 45, 57, 53, 63, 43, 49, 35, 46, 41, 58, 38, 49, 64, 42, 54, 46, 53, 41, 44, 35, 40, 39, 43, 55, 56, 48, 43, 34, 34, 33, 35, 29, 27, 29, 26, 19, 27, 28, 32, 31, 20, 22, 26, 19, 14, 18, 17, 13, 9, 14, 10, 9, 14, 11, 12, 10, 10, 8, 11, 10, 6, 8, 9, 3, 6, 8, 5, 6, 6, 3, 3, 6, 9, 4, 3, 1, 2, 2, 2, 2, 5, 3, 3, 1, 1, 2, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 3, 2, 3, 1, 1, 2, 2, 2, 3, 4, 2, 4, 2, 3, 3, 2, 2, 1, 2, 1, 7, 6, 8, 4, 1, 3, 5, 5, 6, 5, 4, 8, 4, 4, 4, 3, 4, 3, 2, 6, 4, 4, 11, 4, 3, 7, 5, 4, 8, 10, 4, 9, 4, 7, 5, 7, 5, 6, 3, 10, 12, 6, 9, 4, 7, 3, 8, 5, 8, 1, 8, 11, 5, 7, 5, 6, 9, 8, 10, 7, 7, 7, 11, 4, 10, 3, 3, 7, 9, 5, 10, 6, 10, 5, 6, 9, 1, 9, 5, 4, 7, 9, 9, 5, 4, 6, 7, 6, 6, 8, 3, 3, 7, 5, 4, 8, 4, 6, 10, 6, 3, 5, 10, 10, 6, 4, 7, 6, 3, 5, 11, 4, 7, 5, 7, 4, 5, 6, 3, 4, 2, 1, 3, 5, 7, 2, 4, 5, 2, 4, 3, 4, 6, 1, 3, 6, 3, 5, 4, 4, 3, 4, 3, 11, 3, 2, 7, 2, 2, 2, 1, 1, 4, 2, 1, 1, 1, 1, 1, 1, 2, 2, 3, 1, 1, 1, 1, 1, 4, 1, 2, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1)

transfer_amount=( 17197005, 242792, 279324, 269744, 250600, 255264, 285908, 337728, 363816, 359960, 327536, 264720, 203528, 146944, 92880, 63360, 51816, 50184, 64752, 84240, 123228, 157608, 219512, 270240, 317600, 365872, 390528, 425712, 423748, 419040, 410936, 380160, 331848, 287368, 240520, 197856, 155992, 130264, 89700, 67360, 47396, 33768, 25456, 16192, 10440, 7360, 4136, 1344, 980, 600, 1020, 216, 220, 224, 228, 464, 708, 240, 1952, 2232, 3780, 6400, 8840, 11616, 12328, 17680, 18492, 31640, 32092, 43776, 60736, 74888, 90900, 118256, 129668, 146952, 173168, 209920, 234252, 271256, 297804, 316848, 325720, 358792, 369924, 389664, 412960, 401760, 414232, 391184, 409944, 383896, 396720, 337152, 326308, 323008, 294624, 266400, 230280, 221952, 215476, 188032, 147840, 124232, 100580, 81216, 75428, 70400, 41736, 47040, 32996, 30096, 19320, 17168, 11700, 11800, 10472, 4800, 2420, 3416, 3936, 1488, 1000, 508, 2048, 2580, 532, 896, 900, 904, 912, 924, 1856, 1872, 2820, 1888, 1896, 4760, 4780, 4800, 4820, 10648, 10692, 9760, 9800, 16728, 7904, 26784, 28884, 29000, 33132, 38304, 38456, 42672, 58140, 58368, 59624, 80496, 84952, 96720, 86652, 110040, 152540, 109824, 149460, 124488, 166608, 172592, 175388, 189000, 190784, 182784, 209664, 206048, 227700, 231840, 286972, 271328, 263376, 258720, 292240, 319224, 307904, 322624, 318060, 299728, 296184, 301824, 319056, 325960, 317772, 327040, 273076, 271656, 299720, 271136, 255420, 257472, 251160, 225600, 214312, 218648, 223008, 176320, 176900, 164016, 163324, 142912, 138432, 112840, 129376, 111072, 96404, 84152, 84420, 87216, 74812, 68688, 66352, 40960, 43656, 46368, 37468, 25920, 24700, 19560, 22236, 24928, 11844, 13200, 11916, 13280, 14652, 6680, 5360, 4032, 2696, 5408, 4068, 2720, 1364, 2752, 2768, 1412, 1416, 3156, 3208, 3212, 3272, 13152, 3300, 3304, 3308, 3312, 6632, 6640, 9972, 9996, 10008, 16700, 10032, 13392, 26816, 23492, 23520, 20184, 13472, 10116, 16880, 23660, 23688, 27104, 27136, 30564, 17000, 30636, 34080, 44356, 34160, 41040, 34240, 41136, 34320, 58412, 37840, 58548, 65512, 48328, 62208, 86500, 65816, 55488, 72912, 111232, 97440, 87100, 83712, 76824, 87400, 108500, 115632, 105240, 105360, 126576, 91520, 98672, 127008, 158940, 123760, 162840, 138216, 141920, 134976, 163576, 167320, 153252, 103472, 189316, 182376, 114560, 172032, 226044, 172416, 197780, 212400, 162180, 205656, 180600, 195264, 162900, 206568, 192284, 228816, 156348, 178360, 127540, 167808, 149732, 212048, 139080, 179536, 234752, 154224, 198504, 169280, 195252, 151208, 162448, 129360, 148000, 144456, 159444, 204160, 208096, 178560, 160132, 126752, 126888, 123288, 130900, 108576, 101196, 108808, 97656, 71440, 101628, 105504, 120704, 117056, 75600, 83248, 98488, 72048, 53144, 68400, 64668, 49504, 34308, 53424, 38200, 34416, 53592, 42152, 46032, 38400, 38440, 30784, 42372, 38560, 23160, 30912, 34812, 11616, 23256, 31040, 19420, 23328, 23352, 11688, 11700, 23424, 35172, 15648, 11748, 3920, 7848, 7856, 7864, 7872, 19700, 11832, 11844, 3952, 3956, 7928, 15872, 7944, 3976, 3980, 3988, 3996, 4016, 4072, 4076, 10708, 10824, 10884, 10904, 10920, 10932, 10944, 10952, 10960, 10972, 10980, 11016, 11020, 11024, 22064, 11036, 11040, 11044, 11048, 11056, 11060, 22144, 11076, 22160, 11088, 22184, 11096, 11100, 11104, 11108, 11116, 11124, 33384, 22264, 33408, 11140, 11148, 22304, 22320, 22328, 33504, 44688, 22352, 44720, 22368, 33564, 33576, 22392, 22400, 11204, 22416, 11212, 78512, 67320, 89792, 44912, 11236, 33720, 56220, 56240, 67512, 56280, 45040, 90112, 45072, 45088, 45104, 33840, 45136, 33864, 22584, 67776, 45200, 45216, 124388, 45248, 33948, 79240, 56620, 45312, 90656, 113360, 45360, 102096, 45392, 79464, 56780, 79520, 56820, 68208, 34116, 113760, 136560, 68304, 102492, 45568, 79772, 34200, 91232, 57040, 91296, 11416, 91360, 125664, 57140, 80024, 57180, 68640, 102996, 91584, 114520, 80192, 80220, 80248, 126148, 45888, 114760, 34440, 34452, 80416, 103428, 57480, 115000, 69024, 115080, 57560, 69096, 103680, 11524, 103752, 57660, 46144, 80780, 103896, 103932, 57760, 46224, 69360, 80948, 69408, 69432, 92608, 34740, 34752, 81116, 57960, 46384, 92800, 46416, 69648, 116120, 69696, 34860, 58120, 116280, 116320, 69816, 46560, 81508, 69888, 34956, 58280, 128260, 46656, 81676, 58360, 81732, 46720, 58420, 70128, 35076, 46784, 23400, 11704, 35124, 58560, 82012, 23440, 46896, 58640, 23464, 46944, 35220, 46976, 70488, 11752, 35268, 70560, 35292, 58840, 47088, 47104, 35340, 47136, 35364, 129756, 35400, 23608, 82656, 23624, 23632, 23640, 11824, 11832, 47344, 23680, 11844, 11852, 11856, 11860, 11868, 11872, 23752, 23760, 35652, 11888, 11892, 11896, 11900, 11908, 47648, 11920, 23848, 23872, 11944, 23904, 23920, 11968, 23952, 11988, 12000, 12012, 12024, 12036, 24080, 24104, 12060, 12072, 12076, 35376, 35512, 35568, 35576, 35624, 35644, 35664, 35680, 35708, 35736, 35748, 35800, 35828, 35856, 71744, 71824, 35928, 35932, 35944, 35956, 71952, 71992, 36020, 36024, 36036, 36044, 36048, 36052, 36056, 36060, 36076, 36088, 36096, 36112, 36128, 36136, 36148, 36156, 36160, 36180, 36184, 36196, 36204, 72416, 36216, 36220, 36228, 36236, 36240, 36248, 36252, 72512, 108840, 36284, 72576, 36292, 72600, 36304, 36312, 36316, 36344, 36348, 36356, 36364, 36368, 109116, 36388, 36396, 72800, 36404, 72864, 36456, 72920, 36464, 72936, 36472, 72952, 36484, 36492, 72992, 36500, 36512, 36516, 36532, 36540, 73096, 36560, 36576, 36584, 36592, 36600, 73216, 36628, 109896, 73280, 36644, 36652, 36664, 36684, 36692, 36708, 36712, 36732, 73504, 110292, 36772, 110328, 36792, 73592, 36804, 36808, 73624, 36820, 36824, 36828, 36836, 36840, 36844, 36852, 73792, 36904, 36916, 36932, 36936, 36956, 36976, 36992, 37012, 74040, 37028, 37044, 37052, 37152, 37196, 37220, 74544, 37304, 37444, 114256, 114484, 114552, 114576, 114664, 114692, 114732, 114828, 114944, 115056, 115160, 115176, 230952, 115580, 115636, 115656, 116580, 116720, 363492, 3670016)
measure_burst=(1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192,
        16384, 32768, 65536, 131072, 262144, 524288, 1048576)
measure_lat=(99.69, 60.973, 31.8107,23.1651,13.873,11.0905,10.8282, 10.7025, 10.637, 10.6059, 10.5901,
        6.39104, 4.59523, 3.70911,3.26604,3.04413,2.93171,2.87666,2.84858,2.83507,2.82805)
index = 0
estimated_lat = []
while(index < len(burst_len)):
    i = 0;
    while(burst_len[index] > measure_burst[i] and i < len(measure_burst) - 1):
        i = i + 1
    if(burst_len[index] == measure_burst[i]):
        lat = measure_lat[i]
    else:
        slope = (measure_lat[i-1] - measure_lat[i])/(measure_burst[i] - measure_burst[i-1])
        lat = measure_lat[i-1] - slope * (burst_len[index] - measure_burst[i-1])
    lat = lat * transfer_amount[index]
    estimated_lat.append(lat)
    index = index + 1

total_access_time = sum(estimated_lat)
accumulated_lat_percent=[]
accumulated_lat = 0.0
for lat in estimated_lat:
    accumulated_lat += lat;
    accumulated_lat_percent.append(accumulated_lat/total_access_time)

plt.loglog(burst_len, burst_freq, 'bo', label='Burst Distribution')
#plt.loglog(burst_len, transfer_amount, 'rs', label='Amount of Transfer')
#plt.semilogy(burst_len, burst_freq, 'bo')
ax.set_xlabel('Burst Length')
ax.set_ylabel('# of Bursts')

ay = ax.twinx()
ay.plot(burst_len, accumulated_lat_percent, 'r^-', label='Memory Access Proportion')
#ay.semilogy(burst_len, transfer_amount, 'ro')
ay.set_ylabel('Accumulated Proportion of Memory Access Time')

lx, labelx = ax.get_legend_handles_labels()
ly, labely = ay.get_legend_handles_labels()
ay.legend(lx + ly, labelx + labely, loc='right')

plt.tight_layout()
#plt.show()
#fig.set_size_inches(8, 6)
plt.savefig("../burst_len_rmat.pdf", bbox_inches='tight', )

